<!DOCTYPE html>
<html>
<head>
    <title>Mirror Links</title>
    <link rel="stylesheet" href="/static/default.css">
    <link rel="stylesheet" href="/static/mirror.css">
</head>
<body>
    <h1>Mirror Links</h1>
    
    <div class="metadata-panel">
        <h2>Links</h2>
        <div class="url-list">
            <div class="url-item" style="flex-direction: column; align-items: flex-start;">
                <div style="display: flex; align-items: center; gap: 8px; width: 100%;">
                    <input type="radio" name="link_variant" value="default" checked>
                    <button class="copy-btn" id="default-link-copy">Copy</button>
                    <span style="min-width: 100px;"><strong>Default</strong></span>
                    <span id="default-link-display"></span>
                </div>
                <div style="margin-left: 140px; color: #666; font-family: monospace; font-size: 0.9em; margin-top: 4px;" id="default-link-html"></div>
            </div>
            <div class="url-item" style="flex-direction: column; align-items: flex-start;">
                <div style="display: flex; align-items: center; gap: 8px; width: 100%;">
                    <input type="radio" name="link_variant" value="custom">
                    <button class="copy-btn" id="custom-link-copy">Copy</button>
                    <span style="min-width: 100px;"><strong>Custom</strong></span>
                    <span id="custom-link-display"></span>
                </div>
                <div style="margin-left: 140px; color: #666; font-family: monospace; font-size: 0.9em; margin-top: 4px;" id="custom-link-html"></div>
            </div>
        </div>
    </div>
    
    <div class="metadata-panel">
        <h2>Title</h2>
        <div class="url-list">
            
                <div class="url-item">
                    <input type="radio" name="title_variant" value="title0" data-text="Beautiful Soup Documentation — Beautiful Soup 4.13.0 documentation" checked>
                    <button class="copy-btn" data-html="Beautiful Soup Documentation — Beautiful Soup 4.13.0 documentation">Copy</button>
                    <span style="min-width: 100px;"><strong>Original</strong></span>
                    <span>Beautiful Soup Documentation — Beautiful Soup 4.13.0 documentation</span>
                </div>
            
                <div class="url-item">
                    <input type="radio" name="title_variant" value="title1" data-text="Beautiful Soup Documentation - Beautiful Soup 4.13.0 documentation" >
                    <button class="copy-btn" data-html="Beautiful Soup Documentation - Beautiful Soup 4.13.0 documentation">Copy</button>
                    <span style="min-width: 100px;"><strong>Path Safe</strong></span>
                    <span>Beautiful Soup Documentation - Beautiful Soup 4.13.0 documentation</span>
                </div>
            
        </div>
    </div>
    
    
    <div class="metadata-panel">
        <h2>Fragment</h2>
        <div class="url-list">
            <div class="url-item">
                <input type="radio" name="fragment_variant" value="none" data-text="" checked>
                <span style="min-width: 100px;"><strong>None</strong></span>
            </div>
            <div class="url-item">
                <input type="radio" name="fragment_variant" value="fragment" data-text="non-pretty-printing">
                <button class="copy-btn" data-html="non-pretty-printing">Copy</button>
                <span style="min-width: 100px;"><strong>Fragment</strong></span>
                <span>non-pretty-printing</span>
            </div>
            <div class="url-item">
                <input type="radio" name="fragment_variant" value="fragment_text" data-text="non-pretty-printing">
                <button class="copy-btn" data-html="non-pretty-printing">Copy</button>
                <span style="min-width: 100px;"><strong>Fragment Text</strong></span>
                <span>non-pretty-printing</span>
            </div>
        </div>
    </div>
    
    
    <div class="metadata-panel">
        <h2>URL</h2>
        <div class="url-list">
            
                <div class="url-item">
                    <input type="radio" name="url_variant" value="url0" data-text="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#non-pretty-printing" checked>
                    <button class="copy-btn" data-html="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#non-pretty-printing">Copy</button>
                    <span style="min-width: 100px;"><strong>With Fragment</strong></span>
                    <span><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#non-pretty-printing">https://www.crummy.com/software/BeautifulSoup/bs4/doc/#non-pretty-printing</a></span>
                </div>
            
                <div class="url-item">
                    <input type="radio" name="url_variant" value="url1" data-text="https://www.crummy.com/software/BeautifulSoup/bs4/doc" >
                    <button class="copy-btn" data-html="https://www.crummy.com/software/BeautifulSoup/bs4/doc">Copy</button>
                    <span style="min-width: 100px;"><strong>Clean</strong></span>
                    <span><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc">https://www.crummy.com/software/BeautifulSoup/bs4/doc</a></span>
                </div>
            
                <div class="url-item">
                    <input type="radio" name="url_variant" value="url2" data-text="https://www.crummy.com/software" >
                    <button class="copy-btn" data-html="https://www.crummy.com/software">Copy</button>
                    <span style="min-width: 100px;"><strong>Root</strong></span>
                    <span><a href="https://www.crummy.com/software">https://www.crummy.com/software</a></span>
                </div>
            
                <div class="url-item">
                    <input type="radio" name="url_variant" value="url3" data-text="https://www.crummy.com" >
                    <button class="copy-btn" data-html="https://www.crummy.com">Copy</button>
                    <span style="min-width: 100px;"><strong>Host</strong></span>
                    <span><a href="https://www.crummy.com">https://www.crummy.com</a></span>
                </div>
            
        </div>
    </div>
    
    
    <div class="favicon-section">
        <h2>Favicon</h2>
        <div class="favicon-display">
            <input type="checkbox" id="include_favicon" checked>
            <img src="https://www.crummy.com/favicon.ico" width="20" alt="Favicon" data-url="https://www.crummy.com/favicon.ico" />
            <button class="copy-btn" data-html="https://www.crummy.com/favicon.ico">Copy</button>
            <a href="https://www.crummy.com/favicon.ico">https://www.crummy.com/favicon.ico</a>
        </div>
    </div>
    

    <div class="metadata-panel">
        <h2>Metadata</h2>
        <div class="metadata-item">
            <strong>Content-Type:</strong> 
        </div>
        <div class="metadata-item">
            <strong>Clipboard Error:</strong> 
        </div>
    </div>

    <script>
        // Store default values
        const defaultValues = {
            title: 'Beautiful Soup Documentation — Beautiful Soup 4.13.0 documentation',
            fragmentText: 'non-pretty-printing',
            url: 'https://www.crummy.com/software/BeautifulSoup/bs4/doc/#non-pretty-printing',
            favicon: 'https://www.crummy.com/favicon.ico'
        };

        // Function to escape HTML for display
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Function to build a link
        function buildLink(title, fragmentText, url, includeFavicon) {
            let html = '';
            
            // Add favicon if requested
            if (includeFavicon && defaultValues.favicon) {
                html += `<img src="${escapeHtml(defaultValues.favicon)}" width="20" alt="Favicon" /> `;
            }
            
            // Add link with appropriate text
            const linkText = fragmentText ? `${fragmentText} - ${title}` : title;
            html += `<a target="_blank" href="${escapeHtml(url)}">${escapeHtml(linkText)}</a>`;
            
            return html;
        }

        // Function to update links
        function updateLinks() {
            // Build default link (always uses original values)
            const defaultLink = buildLink(
                defaultValues.title,
                defaultValues.fragmentText,
                defaultValues.url,
                true // always include favicon for default
            );
            
            // Display default link
            document.getElementById('default-link-display').innerHTML = defaultLink;
            document.getElementById('default-link-html').textContent = defaultLink;
            document.getElementById('default-link-copy').dataset.html = defaultLink;
            
            // Build custom link from selections
            const titleRadio = document.querySelector('input[name="title_variant"]:checked');
            const title = titleRadio ? titleRadio.dataset.text : defaultValues.title;
            
            const fragmentRadio = document.querySelector('input[name="fragment_variant"]:checked');
            const fragmentText = fragmentRadio ? fragmentRadio.dataset.text : '';
            
            const urlRadio = document.querySelector('input[name="url_variant"]:checked');
            const url = urlRadio ? urlRadio.dataset.text : defaultValues.url;
            
            const faviconCheckbox = document.getElementById('include_favicon');
            const includeFavicon = faviconCheckbox ? faviconCheckbox.checked : false;
            
            const customLink = buildLink(title, fragmentText, url, includeFavicon);
            
            // Display custom link
            document.getElementById('custom-link-display').innerHTML = customLink;
            document.getElementById('custom-link-html').textContent = customLink;
            document.getElementById('custom-link-copy').dataset.html = customLink;
            
            // Auto-copy custom link when selections change
            if (linksInitialized) {
                navigator.clipboard.writeText(customLink).then(() => {
                    console.log('Custom link copied to clipboard');
                });
            }
        }

        // Function to attach copy button listeners
        function attachCopyListeners() {
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (btn.dataset.html) {
                        navigator.clipboard.writeText(btn.dataset.html).then(() => {
                            console.log('HTML copied to clipboard');
                        });
                    }
                });
            });
        }

        // Track initialization
        let linksInitialized = false;

        // Attach listeners on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Build initial links
            updateLinks();
            
            // Attach copy listeners
            attachCopyListeners();
            
            // Auto-copy default link on page load
            setTimeout(() => {
                const defaultLink = document.getElementById('default-link-copy').dataset.html;
                if (defaultLink) {
                    navigator.clipboard.writeText(defaultLink).then(() => {
                        console.log('Default link copied to clipboard');
                        linksInitialized = true;
                    });
                }
            }, 100);
            
            // Listen for changes to update custom link
            document.querySelectorAll('input[type="radio"]:not([name="link_variant"]), input[type="checkbox"]').forEach(input => {
                input.addEventListener('change', updateLinks);
            });
        });
    </script>
</body>
</html>