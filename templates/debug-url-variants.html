<!DOCTYPE html>
<html>
<head>
    <title>Debug URL Variants</title>
    <link rel="stylesheet" href="/static/default.css">
    <link rel="stylesheet" href="/static/mirror.css">
</head>
<body>
    <h1>Debug URL Variants</h1>
    
    <div class="metadata-panel">
        <h2>Input</h2>
        <form method="POST">
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="text" name="url" value="{{ input_url|e }}" placeholder="Enter URL..." style="flex: 1; padding: 8px; font-size: 14px;">
                <button type="submit" style="padding: 8px 16px; font-size: 14px;">Generate</button>
            </div>
        </form>
    </div>
    
    {% if url_variants %}
    <div class="metadata-panel">
        <h2>URL Variants</h2>
        <div class="url-list">
            {% for variant in url_variants %}
                <div class="url-item"{% if variant.is_duplicate %} style="opacity: 0.6; background-color: #f5f5f5;"{% endif %}>
                    <button class="copy-btn" data-html="{{ variant.url|e }}">Copy</button>
                    <span style="min-width: 100px;"><strong>{{ variant.label }}</strong></span>
                    <span><a href="{{ variant.url|e }}">{{ variant.url|e }}</a></span>
                </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <script>
        // Function to show tooltip
        function showTooltip(btn, message) {
            const tooltip = document.createElement('span');
            tooltip.textContent = message;
            tooltip.style.cssText = 'position: absolute; background: #333; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; white-space: nowrap; z-index: 1000; pointer-events: none;';
            
            const rect = btn.getBoundingClientRect();
            tooltip.style.left = rect.left + 'px';
            tooltip.style.top = (rect.top - 30) + 'px';
            
            document.body.appendChild(tooltip);
            
            setTimeout(() => {
                tooltip.remove();
            }, 1500);
        }

        // Function to attach copy button listeners
        function attachCopyListeners() {
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (btn.dataset.html) {
                        navigator.clipboard.writeText(btn.dataset.html).then(() => {
                            console.log('Copied to clipboard:', btn.dataset.html);
                            showTooltip(btn, 'Copied!');
                        }).catch(err => {
                            console.error('Failed to copy:', err);
                        });
                    }
                });
            });
        }

        // Attach listeners on page load
        document.addEventListener('DOMContentLoaded', function() {
            attachCopyListeners();
        });
    </script>
</body>
</html>
